<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Serverless Streaming Analytics with S3 Tables &amp; Firehose | Manu Mishra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="author" content="Manu Mishra"><meta data-rh="true" name="msvalidate.01" content="8D78E08118D465445E0BA072DB19A547"><meta data-rh="true" property="og:url" content="https://manumishra.com"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:title" content="Manu Mishra - Distinguished Solutions Architect, Author &amp; Researcher in AI &amp; Cloud"><meta data-rh="true" name="twitter:description" content="Discover cutting-edge insights, published research, and proven expertise in AI, machine learning, and cloud-native architectures from an industry-leading solutions architect, technical author, and researcher."><meta data-rh="true" property="og:title" content="Serverless Streaming Analytics with S3 Tables &amp; Firehose | Manu Mishra"><meta data-rh="true" name="description" content="Build a production-ready serverless streaming analytics pipeline using Amazon S3 Tables and Kinesis Data Firehose. Query 600K records/hour with Apache Iceberg format, automated governance, and zero infrastructure management."><meta data-rh="true" property="og:description" content="Build a production-ready serverless streaming analytics pipeline using Amazon S3 Tables and Kinesis Data Firehose. Query 600K records/hour with Apache Iceberg format, automated governance, and zero infrastructure management."><meta data-rh="true" name="keywords" content="amazon s3 tables,kinesis data firehose,streaming analytics,apache iceberg,serverless,aws lambda,lake formation,real-time analytics,iot data,terraform"><meta data-rh="true" property="og:image" content="https://manumishra.com/img/blog/s3table-firehose-lambda-architecture.png"><meta data-rh="true" name="twitter:image" content="https://manumishra.com/img/blog/s3table-firehose-lambda-architecture.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2026-01-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/manu-mishra"><meta data-rh="true" property="article:tag" content="aws,serverless,streaming analytics,amazon bedrock,s3 tables,kinesis,apache iceberg,terraform,iot,data governance"><link data-rh="true" rel="icon" href="/img/manu-mishra-fav-icon.png"><link data-rh="true" rel="canonical" href="https://manumishra.com/blog/s3-tables-streaming-analytics"><link data-rh="true" rel="alternate" href="https://manumishra.com/blog/s3-tables-streaming-analytics" hreflang="en"><link data-rh="true" rel="alternate" href="https://manumishra.com/blog/s3-tables-streaming-analytics" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://manumishra.com/blog/s3-tables-streaming-analytics","mainEntityOfPage":"https://manumishra.com/blog/s3-tables-streaming-analytics","url":"https://manumishra.com/blog/s3-tables-streaming-analytics","headline":"Serverless Streaming Analytics with S3 Tables & Firehose","name":"Serverless Streaming Analytics with S3 Tables & Firehose","description":"Build a production-ready serverless streaming analytics pipeline using Amazon S3 Tables and Kinesis Data Firehose. Query 600K records/hour with Apache Iceberg format, automated governance, and zero infrastructure management.","datePublished":"2026-01-25T00:00:00.000Z","author":{"@type":"Person","name":"Manu Mishra","description":"Distinguished Solutions Architect, Author & Researcher in AI & Cloud","url":"https://github.com/manu-mishra","image":"/img/logo.png"},"image":{"@type":"ImageObject","@id":"https://manumishra.com/img/blog/s3table-firehose-lambda-architecture.png","url":"https://manumishra.com/img/blog/s3table-firehose-lambda-architecture.png","contentUrl":"https://manumishra.com/img/blog/s3table-firehose-lambda-architecture.png","caption":"title image for the blog post: Serverless Streaming Analytics with S3 Tables & Firehose"},"keywords":["amazon s3 tables","kinesis data firehose","streaming analytics","apache iceberg","serverless","aws lambda","lake formation","real-time analytics","iot data","terraform"],"isPartOf":{"@type":"Blog","@id":"https://manumishra.com/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Manu Mishra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Manu Mishra Atom Feed">
<script src="/scripts/apply-theme.js"></script><link rel="stylesheet" href="/assets/css/styles.e2a0b64d.css">
<script src="/assets/js/runtime~main.03b14b05.js" defer="defer"></script>
<script src="/assets/js/main.9c5bf54f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Manu Mishra Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Manu Mishra Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Manu Mishra</b></a><a class="navbar__item navbar__link" href="/experience">Experience</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/about">About</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/manu-mishra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://linkedin.com/in/manu-mishra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All Blog Posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2026</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/open-claw-fleet-virtual-organizations-ai-agents">Open-Claw-Fleet - Running Thousands of AI Agents on AWS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/universal-image-mcp-multi-provider-image-generation">Universal Image MCP - One Server, Three AI Image Providers</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/s3-tables-streaming-analytics">Serverless Streaming Analytics with S3 Tables &amp; Firehose</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/recursive-language-models-strands-agentcore">Recursive Language Models on AWS with Strands Agents</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/aws-reinvent-2025-reinvented-powered-by-mcp">AWS Re:Invent 2025, Reinvented — Powered by MCP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/embeddings-gemma-on-lambda">Google&#x27;s EmbeddingGemma on AWS Lambda - A Curiosity-Driven Experiment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/deploy-microsoft-bitnet-llm-on-aws-lambda">Running 1.58-bit LLMs on AWS Lambda with BitNet</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/threat-modeling-autonomous-ai">Threat Modeling for Autonomous AI - What OWASP Wants You to Know</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/data-governance-playbook">Data Governance Playbook - From Chaos to Confidence</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/digital-standstill-theory-constraints">Digital Standstill &amp; Theory of Constraints</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/three-cs-of-coe">The Three &quot;C&quot;s of COE - From Center to Centering to Culture of Excellence</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/priming-business-flywheel-genai">Priming Business Flywheel with Gen-AI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/unified-systems">Unified Systems - The Tech Trend You Never Knew You Needed</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/api-first-ai-era">Rethinking API-First - Unveiling Its True Power in the AI Era</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/llm-technical-debt">The Future with Large Language Models - A Technical Debt Worth Taking</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/software-craftsmanship">Software Craftsmanship - Objectify Tools, Not Debates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/software-engineer-vs-developer">Software Engineer vs. Developer through the Lens of Socratic Questioning</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/digital-inertia">KTLO Can Lead to Digital Inertia and Hinder Digital Transformation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/dont-keep-lights-on">Don&#x27;t Keep The Lights On</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Serverless Streaming Analytics with S3 Tables &amp; Firehose</h1><div class="container_mt6G margin-vert--md"><time datetime="2026-01-25T00:00:00.000Z">January 25, 2026</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/manu-mishra" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="/img/logo.png" alt="Manu Mishra"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/manu-mishra" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Manu Mishra</span></a></div><small class="authorTitle_nd0D" title="Distinguished Solutions Architect, Author &amp; Researcher in AI &amp; Cloud">Distinguished Solutions Architect, Author &amp; Researcher in AI &amp; Cloud</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><img decoding="async" loading="lazy" alt="S3 Tables Architecture" src="/assets/images/s3table-firehose-lambda-architecture-ed9ce43ab8d5e9cf3241b54f2a4fc265.png" width="1536" height="1024" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2>
<p>Modern businesses need to analyze streaming data in real-time to make faster decisions. Whether it&#x27;s monitoring IoT sensors, tracking user behavior, or processing financial transactions, the ability to query fresh data immediately is critical. However, building a streaming analytics pipeline traditionally requires managing complex infrastructure and dealing with data format conversions.</p>
<p>This solution shows how to build a serverless real-time streaming analytics pipeline using <a href="https://aws.amazon.com/s3/features/tables/" target="_blank" rel="noopener noreferrer">Amazon S3 Tables</a> and <a href="https://aws.amazon.com/kinesis/data-firehose/" target="_blank" rel="noopener noreferrer">Amazon Kinesis Data Firehose</a>. By combining streaming ingestion with Apache Iceberg&#x27;s analytics-optimized format, you can query data within minutes of generation—without managing any servers or data transformation jobs.</p>
<p><strong>GitHub Repository:</strong> <a href="https://github.com/manu-mishra/s3table-firehose-lambda-terraform-demo" target="_blank" rel="noopener noreferrer">https://github.com/manu-mishra/s3table-firehose-lambda-terraform-demo</a></p>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-overview">Architecture Overview<a href="#architecture-overview" class="hash-link" aria-label="Direct link to Architecture Overview" title="Direct link to Architecture Overview">​</a></h2>
<p>The solution creates an end-to-end streaming analytics pipeline that generates IoT sensor data using <a href="https://aws.amazon.com/lambda/" target="_blank" rel="noopener noreferrer">AWS Lambda</a>, simulating 10 sensors across multiple locations. Data streams continuously through Amazon Kinesis Data Firehose with automatic buffering and delivery, then gets stored in Apache Iceberg format using Amazon S3 Tables for optimized analytics performance. The solution integrates with <a href="https://aws.amazon.com/lake-formation/" target="_blank" rel="noopener noreferrer">AWS Lake Formation</a> for centralized data governance and access control.</p>
<p>The solution generates approximately <strong>600,000 records per hour</strong> from simulated IoT sensors, demonstrating real-world streaming data patterns for temperature, humidity, and pressure monitoring across warehouse and office locations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-components">Key Components<a href="#key-components" class="hash-link" aria-label="Direct link to Key Components" title="Direct link to Key Components">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-generation-layer">Data Generation Layer<a href="#data-generation-layer" class="hash-link" aria-label="Direct link to Data Generation Layer" title="Direct link to Data Generation Layer">​</a></h3>
<p><strong>AWS Lambda</strong> (512 MB memory) generates 10,000 IoT sensor records per invocation at a rate of 200 records per second. The function is triggered every minute by <a href="https://aws.amazon.com/eventbridge/" target="_blank" rel="noopener noreferrer">Amazon EventBridge</a>, producing consistent data flow for the pipeline. An <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS Identity and Access Management (IAM)</a> role grants the Lambda function permissions to write to Firehose and <a href="https://aws.amazon.com/cloudwatch/" target="_blank" rel="noopener noreferrer">Amazon CloudWatch</a> Logs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="streaming-layer">Streaming Layer<a href="#streaming-layer" class="hash-link" aria-label="Direct link to Streaming Layer" title="Direct link to Streaming Layer">​</a></h3>
<p><strong>Amazon Kinesis Data Firehose</strong> buffers incoming data for up to 5 minutes or 5 MB before writing to the destination. An IAM role provides Firehose with permissions to access S3 Tables via Lake Formation, write to the error bucket, and use <a href="https://aws.amazon.com/kms/" target="_blank" rel="noopener noreferrer">AWS Key Management Service (AWS KMS)</a> for encryption.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-layer">Storage Layer<a href="#storage-layer" class="hash-link" aria-label="Direct link to Storage Layer" title="Direct link to Storage Layer">​</a></h3>
<p><strong>Amazon S3 Tables</strong> stores data in Apache Iceberg format with automatic schema management and table optimization. The table bucket is encrypted using AWS KMS customer-managed keys.</p>
<p><strong>Amazon Simple Storage Service (Amazon S3) Error Bucket</strong> captures failed deliveries from Firehose when records cannot be written to S3 Tables. The error bucket is encrypted with AWS KMS customer-managed keys and has versioning enabled for audit trails. Failed records are written to the <code>errors/</code> prefix with metadata about the failure reason, enabling troubleshooting and data recovery.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="governance-layer">Governance Layer<a href="#governance-layer" class="hash-link" aria-label="Direct link to Governance Layer" title="Direct link to Governance Layer">​</a></h3>
<p><strong>AWS Lake Formation</strong> grants explicit permissions (ALL, ALTER, DELETE, DESCRIBE, DROP, INSERT, SELECT) to the Firehose role for database, table, and column access, ensuring secure and governed data access patterns.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-layer">Monitoring Layer<a href="#monitoring-layer" class="hash-link" aria-label="Direct link to Monitoring Layer" title="Direct link to Monitoring Layer">​</a></h3>
<p><strong>Amazon CloudWatch Dashboard</strong> provides real-time monitoring of Firehose metrics, Lambda performance, and S3 Tables storage with 9 pre-configured widgets tracking key operational metrics.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-schema">Data Schema<a href="#data-schema" class="hash-link" aria-label="Direct link to Data Schema" title="Direct link to Data Schema">​</a></h2>
<p>The solution generates IoT sensor data with the following schema:</p>
<ul>
<li><strong>sensor_id</strong> (string): Unique identifier for each sensor</li>
<li><strong>timestamp</strong> (long): Unix timestamp in seconds</li>
<li><strong>location</strong> (string): Physical location of the sensor</li>
<li><strong>temperature</strong> (double): Temperature reading in Celsius</li>
<li><strong>humidity</strong> (double): Humidity percentage</li>
<li><strong>pressure</strong> (double): Atmospheric pressure in hPa</li>
</ul>
<p>Data generation rate: 200 records per second during Lambda execution, producing approximately 10,000 records per invocation and 600,000 records per hour across all sensors.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="one-time-account-configuration">One-Time Account Configuration<a href="#one-time-account-configuration" class="hash-link" aria-label="Direct link to One-Time Account Configuration" title="Direct link to One-Time Account Configuration">​</a></h3>
<ol>
<li>
<p><strong>Enable S3 Tables Integration with Lake Formation</strong></p>
<ul>
<li>Navigate to the <a href="https://console.aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3 console</a></li>
<li>Select <strong>Table buckets</strong> in the left navigation</li>
<li>Click <strong>Enable integration</strong></li>
<li>This registers S3 Tables with AWS Lake Formation</li>
</ul>
</li>
<li>
<p><strong>Configure Lake Formation Administrator Permissions</strong></p>
<ul>
<li>The IAM identity running Terraform requires Lake Formation administrator permissions</li>
<li>Navigate to the <a href="https://console.aws.amazon.com/lakeformation/" target="_blank" rel="noopener noreferrer">AWS Lake Formation console</a></li>
<li>Select <strong>Administrative roles and tasks</strong> → <strong>Choose administrators</strong></li>
<li>Add your IAM user or role</li>
</ul>
<p>Alternatively, use the AWS CLI:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws lakeformation put-data-lake-settings \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --data-lake-settings &#x27;{&quot;DataLakeAdmins&quot;:[{&quot;DataLakePrincipalIdentifier&quot;:&quot;arn:aws:iam::ACCOUNT:user/YOUR_USER&quot;}]}&#x27;</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-tools">Required Tools<a href="#required-tools" class="hash-link" aria-label="Direct link to Required Tools" title="Direct link to Required Tools">​</a></h3>
<ul>
<li><a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a> &gt;= 1.0</li>
<li><a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener noreferrer">AWS Command Line Interface (AWS CLI)</a> &gt;= 2.15 (for S3 Tables support)</li>
<li>AWS credentials configured</li>
<li>Terraform AWS Provider &gt;= 6.0 (for S3 Tables schema support)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validation-script">Validation Script<a href="#validation-script" class="hash-link" aria-label="Direct link to Validation Script" title="Direct link to Validation Script">​</a></h3>
<p>The solution includes a validation script to verify all prerequisites before deployment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./validate-prerequisites.sh</span><br></span></code></pre></div></div>
<p>This script checks:</p>
<ul>
<li>AWS credentials configuration</li>
<li>S3 Tables integration with Lake Formation is enabled</li>
<li>Current IAM identity is a Lake Formation administrator</li>
<li>Required IAM permissions are available</li>
<li>AWS CLI version supports S3 Tables (v2.15+)</li>
<li>Terraform is installed (v1.0+)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure-as-code">Infrastructure as Code<a href="#infrastructure-as-code" class="hash-link" aria-label="Direct link to Infrastructure as Code" title="Direct link to Infrastructure as Code">​</a></h3>
<p>The solution uses <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a> to provision all AWS resources. The deployment creates:</p>
<ul>
<li>S3 Tables table bucket, namespace, and Iceberg table with schema (KMS encrypted)</li>
<li>Kinesis Data Firehose delivery stream with Iceberg destination</li>
<li>Amazon S3 error bucket for failed deliveries (KMS encrypted)</li>
<li>AWS Lambda data generator function (512 MB, triggered every minute)</li>
<li>Amazon EventBridge schedule rule</li>
<li>IAM roles and policies for Firehose and Lambda</li>
<li>AWS KMS customer-managed encryption key</li>
<li>Amazon CloudWatch dashboard with 9 monitoring widgets</li>
<li>AWS Lake Formation permissions (automated via Terraform)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deployment-steps">Deployment Steps<a href="#deployment-steps" class="hash-link" aria-label="Direct link to Deployment Steps" title="Direct link to Deployment Steps">​</a></h3>
<ol>
<li>
<p>Configure <code>terraform.tfvars</code> with your stack name (must be globally unique):</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">stack_name = &quot;your-unique-stack-name&quot;</span><br></span></code></pre></div></div>
</li>
<li>
<p>Deploy the infrastructure:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">terraform init</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">terraform apply</span><br></span></code></pre></div></div>
</li>
</ol>
<p>All resources are created with Lake Formation permissions automatically granted during deployment.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verification">Verification<a href="#verification" class="hash-link" aria-label="Direct link to Verification" title="Direct link to Verification">​</a></h3>
<p>Lambda begins sending data immediately. Wait 5-6 minutes for Firehose buffering, then verify data flow using the Amazon CloudWatch dashboard. The dashboard provides real-time visibility into:</p>
<ul>
<li>Firehose incoming records and delivery metrics</li>
<li>Lambda invocations and performance</li>
<li>S3 Tables storage growth</li>
</ul>
<p>Access the dashboard URL from Terraform outputs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">terraform output dashboard_url</span><br></span></code></pre></div></div>
<p>Alternatively, check for delivery errors:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws s3 ls s3://{stack_name}-errors/errors/ --recursive</span><br></span></code></pre></div></div>
<p>An empty result indicates successful data delivery.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="querying-data">Querying Data<a href="#querying-data" class="hash-link" aria-label="Direct link to Querying Data" title="Direct link to Querying Data">​</a></h2>
<p>After deployment, query the streaming data stored in S3 Tables using Apache Iceberg-compatible query engines:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="view-all-sensor-data">View All Sensor Data<a href="#view-all-sensor-data" class="hash-link" aria-label="Direct link to View All Sensor Data" title="Direct link to View All Sensor Data">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> firehosetos3demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">firehosetos3demo </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="average-temperature-by-location">Average Temperature by Location<a href="#average-temperature-by-location" class="hash-link" aria-label="Direct link to Average Temperature by Location" title="Direct link to Average Temperature by Location">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">AVG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temperature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> avg_temp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">COUNT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> reading_count</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> firehosetos3demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">firehosetos3demo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> avg_temp </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DESC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recent-high-temperature-alerts">Recent High Temperature Alerts<a href="#recent-high-temperature-alerts" class="hash-link" aria-label="Direct link to Recent High Temperature Alerts" title="Direct link to Recent High Temperature Alerts">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sensor_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    temperature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    humidity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    from_unixtime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> reading_time</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> firehosetos3demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">firehosetos3demo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">WHERE</span><span class="token plain"> temperature </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">LIMIT</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sensor-activity-summary">Sensor Activity Summary<a href="#sensor-activity-summary" class="hash-link" aria-label="Direct link to Sensor Activity Summary" title="Direct link to Sensor Activity Summary">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sensor_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">COUNT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> total_readings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">AVG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temperature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> avg_temp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">AVG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">humidity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> avg_humidity</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">MIN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> first_reading</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">MAX</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> last_reading</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> firehosetos3demo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">firehosetos3demo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> sensor_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> location</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> sensor_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-and-operations">Monitoring and Operations<a href="#monitoring-and-operations" class="hash-link" aria-label="Direct link to Monitoring and Operations" title="Direct link to Monitoring and Operations">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudwatch-dashboard">CloudWatch Dashboard<a href="#cloudwatch-dashboard" class="hash-link" aria-label="Direct link to CloudWatch Dashboard" title="Direct link to CloudWatch Dashboard">​</a></h3>
<p>The solution includes a pre-configured Amazon CloudWatch dashboard with the following metrics:</p>
<p><strong>Firehose Metrics:</strong></p>
<ul>
<li>Incoming records</li>
<li>Delivery success/failure counts</li>
<li>Data freshness (time from arrival to delivery)</li>
<li>Bytes delivered</li>
</ul>
<p><strong>Lambda Metrics:</strong></p>
<ul>
<li>Invocations</li>
<li>Errors</li>
<li>Duration</li>
</ul>
<p><strong>S3 Tables Metrics:</strong></p>
<ul>
<li>Storage size</li>
<li>File count</li>
</ul>
<p>Access the dashboard URL from Terraform outputs:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">terraform output dashboard_url</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-monitoring">Error Monitoring<a href="#error-monitoring" class="hash-link" aria-label="Direct link to Error Monitoring" title="Direct link to Error Monitoring">​</a></h3>
<p>Check for delivery failures:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aws s3 ls s3://{stack_name}-errors/errors/iceberg-failed/ --recursive</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="encryption">Encryption<a href="#encryption" class="hash-link" aria-label="Direct link to Encryption" title="Direct link to Encryption">​</a></h3>
<ul>
<li><strong>At Rest</strong>: All data in S3 Tables and the error bucket is encrypted using AWS KMS customer-managed keys with automatic key rotation enabled</li>
<li><strong>In Transit</strong>: All data transfers use TLS encryption</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-control">Access Control<a href="#access-control" class="hash-link" aria-label="Direct link to Access Control" title="Direct link to Access Control">​</a></h3>
<ul>
<li><strong>IAM Roles</strong>: Least-privilege IAM policies for Lambda and Firehose</li>
<li><strong>Lake Formation</strong>: Fine-grained access control at database, table, and column levels</li>
<li><strong>KMS Key Policies</strong>: Explicit permissions for service principals and roles</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cost-optimization">Cost Optimization<a href="#cost-optimization" class="hash-link" aria-label="Direct link to Cost Optimization" title="Direct link to Cost Optimization">​</a></h2>
<p>The solution implements several cost optimization strategies:</p>
<ul>
<li><strong>Firehose Buffering</strong>: 5-minute or 5 MB buffering reduces the number of small files written to S3 Tables</li>
<li><strong>CloudWatch Logs Retention</strong>: 1-day retention for Lambda logs reduces storage costs</li>
<li><strong>S3 Tables Maintenance</strong>: Automatic compaction and optimization reduce storage costs over time</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-implementation-notes">Technical Implementation Notes<a href="#technical-implementation-notes" class="hash-link" aria-label="Direct link to Technical Implementation Notes" title="Direct link to Technical Implementation Notes">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schema-definition">Schema Definition<a href="#schema-definition" class="hash-link" aria-label="Direct link to Schema Definition" title="Direct link to Schema Definition">​</a></h3>
<p>Amazon Kinesis Data Firehose requires S3 Tables to have a pre-defined schema. The solution uses Terraform AWS Provider 6.0+ which supports schema definition via the <code>metadata</code> block:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">metadata {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  iceberg {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    schema {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      field {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        name     = &quot;sensor_id&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        type     = &quot;string&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        required = false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      # Additional fields...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lake-formation-permissions">Lake Formation Permissions<a href="#lake-formation-permissions" class="hash-link" aria-label="Direct link to Lake Formation Permissions" title="Direct link to Lake Formation Permissions">​</a></h3>
<p>The solution uses Terraform&#x27;s <code>null_resource</code> with <code>local-exec</code> provisioner to automatically grant Lake Formation permissions using the AWS CLI during deployment. This approach is necessary because Terraform&#x27;s <code>aws_lakeformation_permissions</code> resource does not support S3 Tables catalog ARNs (format: <code>account:s3tablescatalog/bucket-name</code>).</p>
<p>The <code>null_resource</code> executes after the foundational resources (S3 Tables, IAM roles) are created but before the Firehose delivery stream is provisioned. This ensures the Firehose role has the required Lake Formation permissions (ALL, ALTER, DELETE, DESCRIBE, DROP, INSERT, SELECT) for database, table, and column access before attempting to write data.</p>
<p>Without these permissions, Firehose would fail with <code>Lakeformation.AccessDenied</code> errors when attempting to write to S3 Tables. The automated approach eliminates manual permission configuration and ensures consistent deployments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="firehose-buffering">Firehose Buffering<a href="#firehose-buffering" class="hash-link" aria-label="Direct link to Firehose Buffering" title="Direct link to Firehose Buffering">​</a></h3>
<p>Amazon Kinesis Data Firehose buffers data for up to 5 minutes (300 seconds) or 5 MB before writing to S3 Tables. This buffering mechanism optimizes write performance and reduces the number of small files, which improves query performance and reduces costs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cleanup">Cleanup<a href="#cleanup" class="hash-link" aria-label="Direct link to Cleanup" title="Direct link to Cleanup">​</a></h2>
<p>To remove all resources:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">terraform destroy</span><br></span></code></pre></div></div>
<p><strong>Note</strong>: The AWS KMS key will be scheduled for deletion with a 7-day waiting period (AWS minimum).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>This solution demonstrates a production-ready pattern for streaming data ingestion into Amazon S3 Tables using Amazon Kinesis Data Firehose. The architecture provides automatic buffering, schema management, encryption, governance, and monitoring capabilities suitable for real-world analytics workloads. The use of Apache Iceberg format through S3 Tables enables efficient querying, ACID transactions, and time travel capabilities for your streaming data.</p>
<p>By combining serverless compute (Lambda), managed streaming (Firehose), and analytics-optimized storage (S3 Tables), you can build scalable real-time analytics pipelines without managing infrastructure. The solution processes 600,000 records per hour with sub-minute query latency, demonstrating the power of modern serverless data architectures on AWS.</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/aws">aws</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/serverless">serverless</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/streaming-analytics">streaming analytics</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/amazon-bedrock">amazon bedrock</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/s-3-tables">s3 tables</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/kinesis">kinesis</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/apache-iceberg">apache iceberg</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/terraform">terraform</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/iot">iot</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/blog/tags/data-governance">data governance</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/universal-image-mcp-multi-provider-image-generation"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Universal Image MCP - One Server, Three AI Image Providers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/recursive-language-models-strands-agentcore"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Recursive Language Models on AWS with Strands Agents</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#architecture-overview" class="table-of-contents__link toc-highlight">Architecture Overview</a></li><li><a href="#key-components" class="table-of-contents__link toc-highlight">Key Components</a><ul><li><a href="#data-generation-layer" class="table-of-contents__link toc-highlight">Data Generation Layer</a></li><li><a href="#streaming-layer" class="table-of-contents__link toc-highlight">Streaming Layer</a></li><li><a href="#storage-layer" class="table-of-contents__link toc-highlight">Storage Layer</a></li><li><a href="#governance-layer" class="table-of-contents__link toc-highlight">Governance Layer</a></li><li><a href="#monitoring-layer" class="table-of-contents__link toc-highlight">Monitoring Layer</a></li></ul></li><li><a href="#data-schema" class="table-of-contents__link toc-highlight">Data Schema</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#one-time-account-configuration" class="table-of-contents__link toc-highlight">One-Time Account Configuration</a></li><li><a href="#required-tools" class="table-of-contents__link toc-highlight">Required Tools</a></li><li><a href="#validation-script" class="table-of-contents__link toc-highlight">Validation Script</a></li></ul></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a><ul><li><a href="#infrastructure-as-code" class="table-of-contents__link toc-highlight">Infrastructure as Code</a></li><li><a href="#deployment-steps" class="table-of-contents__link toc-highlight">Deployment Steps</a></li><li><a href="#verification" class="table-of-contents__link toc-highlight">Verification</a></li></ul></li><li><a href="#querying-data" class="table-of-contents__link toc-highlight">Querying Data</a><ul><li><a href="#view-all-sensor-data" class="table-of-contents__link toc-highlight">View All Sensor Data</a></li><li><a href="#average-temperature-by-location" class="table-of-contents__link toc-highlight">Average Temperature by Location</a></li><li><a href="#recent-high-temperature-alerts" class="table-of-contents__link toc-highlight">Recent High Temperature Alerts</a></li><li><a href="#sensor-activity-summary" class="table-of-contents__link toc-highlight">Sensor Activity Summary</a></li></ul></li><li><a href="#monitoring-and-operations" class="table-of-contents__link toc-highlight">Monitoring and Operations</a><ul><li><a href="#cloudwatch-dashboard" class="table-of-contents__link toc-highlight">CloudWatch Dashboard</a></li><li><a href="#error-monitoring" class="table-of-contents__link toc-highlight">Error Monitoring</a></li></ul></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a><ul><li><a href="#encryption" class="table-of-contents__link toc-highlight">Encryption</a></li><li><a href="#access-control" class="table-of-contents__link toc-highlight">Access Control</a></li></ul></li><li><a href="#cost-optimization" class="table-of-contents__link toc-highlight">Cost Optimization</a></li><li><a href="#technical-implementation-notes" class="table-of-contents__link toc-highlight">Technical Implementation Notes</a><ul><li><a href="#schema-definition" class="table-of-contents__link toc-highlight">Schema Definition</a></li><li><a href="#lake-formation-permissions" class="table-of-contents__link toc-highlight">Lake Formation Permissions</a></li><li><a href="#firehose-buffering" class="table-of-contents__link toc-highlight">Firehose Buffering</a></li></ul></li><li><a href="#cleanup" class="table-of-contents__link toc-highlight">Cleanup</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Portfolio</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/experience">Experience</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/about">About</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connect</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/manu-mishra" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://linkedin.com/in/manu-mishra" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:mishra.manu@outlook.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Email<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Manu Mishra. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>